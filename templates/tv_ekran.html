<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <title>Berza Koktela - LIVE</title>
    <style>
        /* Moderni, tamni stil za TV ekran */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: #1a1a1a; 
            color: #fff; 
            padding: 20px;
        }
        h1 { 
            text-align: center; 
            color: #4CAF50; /* Zeleni naslov */
            font-size: 3em;
            margin-bottom: 30px;
        }
        #tabela-cena { 
            width: 80%; 
            margin: 0 auto; 
            border-collapse: collapse; 
            font-size: 2.2em; /* Veliki font za TV */
        }
        #tabela-cena th, #tabela-cena td { 
            padding: 20px 30px; 
            text-align: left; 
            border-bottom: 1px solid #333; 
        }
        #tabela-cena th { 
            background-color: #2c2c2c; 
            font-weight: 300;
        }
        .cena { 
            font-weight: bold; 
            white-space: nowrap;
        }
        .indikator { 
            font-size: 1.5em; 
            margin-left: 15px; 
            animation: blink 1s infinite alternate; /* Animacija za isticanje promene */
        }
        .gore { 
            color: #4CAF50; /* Zelena za rast */
        } 
        .dole { 
            color: #f44336; /* Crvena za pad */
        }
        .stabilno {
            color: #aaa;
        }
        
        /* CSS Animacija za treperenje */
        @keyframes blink {
            from { opacity: 1; }
            to { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <h1>Berza Koktela - LIVE CENE</h1>
    
    <table id="tabela-cena">
        <thead>
            <tr>
                <th>Koktel</th>
                <th style="width: 25%;">Cena (RSD)</th>
            </tr>
        </thead>
        <tbody id="lista-koktela">
            </tbody>
    </table>

    <script>
        const listaKoktelaElement = document.getElementById('lista-koktela');

        function azurirajPrikazCena() {
            // Asinhroni poziv API rute koju ste definisali (/api/cene_uzivo)
            fetch('/api/cene_uzivo')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Mreza nije odgovorila.');
                    }
                    return response.json();
                })
                .then(data => {
                    listaKoktelaElement.innerHTML = ''; // Brisanje starog sadrzaja
                    
                    data.forEach(koktel => {
                        let klasaIndikatora = '';
                        let strelica = '';

                        // Postavljanje strelice i boje na osnovu 'smer' (1, 0, -1)
                        if (koktel.smer === 1) {
                            strelica = '▲'; 
                            klasaIndikatora = 'gore';
                        } else if (koktel.smer === -1) {
                            strelica = '▼';
                            klasaIndikatora = 'dole';
                        } else {
                             strelica = '—';
                             klasaIndikatora = 'stabilno';
                        }

                        const red = document.createElement('tr');
                        red.innerHTML = `
                            <td>${koktel.naziv}</td>
                            <td class="cena">
                                ${koktel.cena.toFixed(2)} RSD
                                <span class="indikator ${klasaIndikatora}">${strelica}</span>
                            </td>
                        `;
                        listaKoktelaElement.appendChild(red);
                    });
                })
                .catch(error => console.error('Greska pri povlacenju cena:', error));
        }

        // 1. Pokreni azuriranje odmah
        azurirajPrikazCena();
        // 2. Ponavljaj svakih 5 sekundi (Polling)
        setInterval(azurirajPrikazCena, 5000); 
    </script>
</body>
</html>